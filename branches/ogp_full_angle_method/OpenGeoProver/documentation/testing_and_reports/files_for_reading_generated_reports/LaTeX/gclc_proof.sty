%
% gclcproof.sty 2006 Predrag Janicic & Pedro Quaresma
%
% Used for processing proofs generated by GCLC theorem prover 
% developed by Predrag Janicic & Pedro Quaresma (2005)
% within GCLC ((c) 1996-2006, Predrag Janicic).
%
% New command "proofstep" used to format a proof step.
%
% New command "proveddisproved" stating if a proof has been
% successful or not:
%   1 = proved (if the conjecture was proved valid)
%   0 = disproved (if the conjecture was proved invalid)
%   2 = Failed to prove the conjecture (if neither of above two)
% 
% New environment "displayproof" used to format the entire proof.
%
%
% Options to process proofs (default values portrait,small,NULL):
%
% style options: (default portrait)
%  portrait - uses the package longtable to generate a multi-page
%             table. 
%  portraitbreqn - uses the package breqn to try to break the
%                  equations. Problems with extra large fractions.
%  landscape - uses the packages lscape, amsmath (with option leqno), 
%              and breqn to generate the list of equations in
%              landscape mode, with numbers on the left, and with 
%              automatic equation breaking. 
%
% Size options: (default value small)
%  It uses the normal size names of LaTeX, from "tiny" up to "large" to
%  define the size of the fonts inside a demonstration. 
% 
% Display of Semantic values: (default NULL, i.e. without any value)
%  semantics - if used, it displays the semantic values of both sides of
%              equations.
%
%%%%%%%%%%
% Examples
%%%%%%%%%%
%
% \usepackage{gclcproof} ( = \usepackage[portrait,small]{gclcproof} )
%   gives you a proof in portrait, small size, without semantics style.
% \usepackage[tiny]{gclcproof})
%   retains the portrait mode (default value), but decrease the size
%   of the fonts used in the proof to tiny. No semantic values
%   displayed.
% \usepackage[portraitbreqn,sematics]{gclcproof}
%   uses the breqn package of the AMSTeX to try to break automatically
%   the equations. Portrait form, small size fonts, semantic values
%   displayed. Note: the breqn package may fail (not being able to
%   process the document) if the proof contains large fractions, breqn
%   it is unable to break them into lines.
% \usepackage[landscape]{gclcproof}
%   uses the packages lscape, amsmath (with option leqno), and breqn 
%   o produce a proof in landscape mode. It is the mode that provides 
%   the larger environment for proofs, so in some proofs it will be the 
%   only one to be able to display the proofs without overlapping of the
%   different elements. Note: the rotation of the proof to landscape
%   mode it is done with Postscript specials, so it may not display
%   properly in some viewers. The size of the fonts it is small, and
%   the sematic values are not displayed. 

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{gclc_proof}
\typeout{Document Style `gclcproof' - Display of proofs generated by GCLC}

%%%
%%% Display of proofs
%%%
% Declare Options
\DeclareOption{portrait}
   {\newcount\displayproofstyle%
    \displayproofstyle=2}
\DeclareOption{landscape}
   {\newcount\displayproofstyle%
    \displayproofstyle=0}
\DeclareOption{portraitbreqn}
   {\newcount\displayproofstyle%
    \displayproofstyle=1}

\DeclareOption{tiny}
   {\newcount\displayproofsize%
    \displayproofsize=0}
\DeclareOption{scriptsize}
   {\newcount\displayproofsize%
    \displayproofsize=1}
\DeclareOption{footnotesize}
   {\newcount\displayproofsize%
    \displayproofsize=2}
\DeclareOption{small}
   {\newcount\displayproofsize%
    \displayproofsize=3}
\DeclareOption{normalsize}
   {\newcount\displayproofsize%
    \displayproofsize=4}
\DeclareOption{large}
   {\newcount\displayproofsize%
    \displayproofsize=5}

\DeclareOption{semantics}
   {\newcount\displaysemantics%
    \displaysemantics=0}

\ProcessOptions

%%%
%%% default values - portrait,small and do not display semantics
%%%
\ifx\displayproofstyle\undefined
  \newcount\displayproofstyle
  \displayproofstyle=2 % portrait
\fi

\ifx\displayproofsize\undefined
  \newcount\displayproofsize
  \displayproofsize=3 % small
\fi

\ifx\displaysemantics\undefined
  \newcount\displaysemantics
  \displaysemantics=1 % do not display semantics
\fi


\newcommand\proveddisproved[1]{
  \ifcase#1

  \vspace*{2mm} 

  \hrule 
  
  \vspace*{2mm}

  The conjecture has been disproved.

  \vspace*{2em}
  \or
  
  \vspace*{2mm} 

  \hrule 
     
  \vspace*{2mm} 
     
  \centerline{Q.E.D.}

  \vspace*{2em}

  \else

  \vspace*{2mm} 

  \hrule 
  
  \vspace*{2mm}

  Failed to prove or disprove the conjecture.

  \vspace*{2em}
  \fi}

\ifcase\displayproofstyle% landscape
 \RequirePackage{color}
 \RequirePackage{lscape}
 \RequirePackage[leqno]{amsmath}
 \RequirePackage{breqn}

 \newcommand\proofstep[5]{
   \begin{dmath}[compact]
     #1 #2 #3 \hfill\condition{\parbox{20em}{#4%
      \ifcase\displaysemantics%
      {\ }(value #5)%
      \else%
      {}%
      \fi}}
   \end{dmath}}

 \newenvironment{displayproof}{\begin{landscape}
     \ifcase\displayproofsize\tiny
     \or\scriptsize
     \or\footnotesize
     \or\small
     \or\normalsize 
     \else\large
     \fi}{
   \end{landscape}}
\or   % portraitbreqn
 \RequirePackage{color}
 \RequirePackage{breqn}

 \newcommand\proofstep[5]{
   \begin{dmath}
     #1 #2 #3 \condition{\parbox{12em}{#4%
      \ifcase\displaysemantics%
      {\ }(value #5)%
      \else%
      {}%
      \fi}}
   \end{dmath}}

 \newenvironment{displayproof}{%
     \ifcase\displayproofstyle\tiny
     \or\scriptsize
     \or\footnotesize
     \or\small
     \or\normalsize
     \else\large
     \fi

   }{}
\else % portrait
  \RequirePackage{color}
  \RequirePackage{longtable}
  \newcounter{proofstepnum}
  \setcounter{proofstepnum}{-1}
  \newdimen\thirtythreepercent
  \newdimen\twentypercent
  \thirtythreepercent=\textwidth
  \divide\thirtythreepercent by  196608 % 33% in points pt, 65536*3
  \twentypercent=\textwidth
  \divide\twentypercent by 327680 % 20% in points, 65536*5
  \newcommand\proofstep[5]{\addtocounter{proofstepnum}{1}
    \parbox{\number\thirtythreepercent pt}{$\displaystyle #1$} & 
    {$\displaystyle #2$} & 
    \parbox{\number\thirtythreepercent pt}{$\displaystyle #3$} & 
    \parbox{\number\twentypercent pt}{#4%
      \ifcase\displaysemantics
      {\ }(value #5)%
      \else
      {}
      \fi} (\theproofstepnum) \\ \\}

  \newenvironment{displayproof}{%
    \ifcase\displayproofsize\tiny
    \or\scriptsize
    \or\footnotesize
    \or\small
    \or\normalsize
    \else\large
    \fi
    \begin{longtable}{llll}}
    {\end{longtable}}
\fi

